---
paths:
  - "internal/parser/**/*.go"
---

# Parser Development Rules

## 責務

- Claude CodeのJSONLログファイルのパース
- ログエントリの構造化
- セッション情報の抽出・集計

## テスト駆動開発（TDD）

- 機能追加前に必ずテストを先に書く
- テストファイルは `*_test.go` の形式
- テストデータは `testdata/` に配置
- 全てのテストはパスする状態を維持

## エラーハンドリング

- すべてのエラーは `fmt.Errorf` でラップして返す
- パースエラーは警告ログを出力し、処理を継続
- ファイルI/Oエラーは致命的エラーとして返す

## パフォーマンス

- 大容量ログファイル（10MB以上）に対応
- `bufio.Scanner` でストリーミング処理
- バッファサイズは最大10MBまで対応
- ベンチマークテストを含める

## 依存関係

- Go標準ライブラリのみ使用
- 外部パッケージは原則禁止
- `internal/api` への依存は禁止（循環参照防止）
